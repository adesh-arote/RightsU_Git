CREATE PROC [dbo].[USPAL_Booking_Sheet_Import_Utility_PI] 
(  
	@Booking_Sheet_Utility Booking_Sheet_Import_Utility READONLY, 
	@CallFor NVARCHAR(MAX),
	@User_Code INT= 143 ,
	@DM_Master_Import_Code INT,
	@Sheet_Name NVARCHAR(MAX)
)
AS
BEGIN
	Declare @Loglevel int;

	select @Loglevel = Parameter_Value from System_Parameter_New where Parameter_Name='loglevel'

	if(@Loglevel< 2)Exec [USPLogSQLSteps] '[USPAL_Booking_Sheet_Import_Utility_PI]', 'Step 1', 0, 'Started Procedure', 0, '' 
		IF(OBJECT_ID('tempdb..#Temp_DM_TIUD') IS NOT NULL) DROP TABLE #Temp_DM_TIUD
		IF(OBJECT_ID('tempdb..#ColumnName') IS NOT NULL) DROP TABLE #ColumnName

		SET NOCOUNT ON
		--HV = HEADER VALIDATION
		--INS = INSERTION
		--CNM = Column Name Mismatch
		--CCM = Coumn Count Mismatch
		--CND = Column Name Duplicate
		--CNE = Column Name Error
		DECLARE @i INT = 1,
				@Output VARCHAR(MAX) = '',
				@CN_Count INT =0,
				@DM_TIU_Count INT =0,
				@Result NVARCHAR(200) = 'S~File Uploaded Successfully~',
				--@CallFor NVARCHAR(MAX) = 'HV',
				@ColNameMismatch NVARCHAR(MAX) = '',
				@ColNameDuplicate NVARCHAR(MAX) = '',
				@IsError CHAR(1) = 'N'

		CREATE TABlE #Temp_DM_TIUD(
			DM_Master_Import_Code INT,
			Sheet_Name NVARCHAR(MAX),
			COL1 NVARCHAR(MAX),
			COL2 NVARCHAR(MAX),
			COL3 NVARCHAR(MAX),
			COL4 NVARCHAR(MAX),
			COL5 NVARCHAR(MAX),
			COL6 NVARCHAR(MAX),
			COL7 NVARCHAR(MAX),
			COL8 NVARCHAR(MAX),
			COL9 NVARCHAR(MAX),
			COL10 NVARCHAR(MAX),
			COL11 NVARCHAR(MAX),
			COL12 NVARCHAR(MAX),
			COL13 NVARCHAR(MAX),
			COL14 NVARCHAR(MAX),
			COL15 NVARCHAR(MAX),
			COL16 NVARCHAR(MAX),
			COL17 NVARCHAR(MAX),
			COL18 NVARCHAR(MAX),
			COL19 NVARCHAR(MAX),
			COL20 NVARCHAR(MAX),
			COL21 NVARCHAR(MAX),
			COL22 NVARCHAR(MAX),
			COL23 NVARCHAR(MAX),
			COL24 NVARCHAR(MAX),
			COL25 NVARCHAR(MAX),
			COL26 NVARCHAR(MAX),
			COL27 NVARCHAR(MAX),
			COL28 NVARCHAR(MAX),
			COL29 NVARCHAR(MAX),
			COL30 NVARCHAR(MAX),
			COL31 NVARCHAR(MAX),
			COL32 NVARCHAR(MAX),
			COL33 NVARCHAR(MAX),
			COL34 NVARCHAR(MAX),
			COL35 NVARCHAR(MAX),
			COL36 NVARCHAR(MAX),
			COL37 NVARCHAR(MAX),
			COL38 NVARCHAR(MAX),
			COL39 NVARCHAR(MAX),
			COL40 NVARCHAR(MAX),
			COL41 NVARCHAR(MAX),
			COL42 NVARCHAR(MAX),
			COL43 NVARCHAR(MAX),
			COL44 NVARCHAR(MAX),
			COL45 NVARCHAR(MAX),
			COL46 NVARCHAR(MAX),
			COL47 NVARCHAR(MAX),
			COL48 NVARCHAR(MAX),
			COL49 NVARCHAR(MAX),
			COL50 NVARCHAR(MAX),
			COL51 NVARCHAR(MAX),
			COL52 NVARCHAR(MAX),
			COL53 NVARCHAR(MAX),
			COL54 NVARCHAR(MAX),
			COL55 NVARCHAR(MAX),
			COL56 NVARCHAR(MAX),
			COL57 NVARCHAR(MAX),
			COL58 NVARCHAR(MAX),
			COL59 NVARCHAR(MAX),
			COL60 NVARCHAR(MAX),
			COL61 NVARCHAR(MAX),
			COL62 NVARCHAR(MAX),
			COL63 NVARCHAR(MAX),
			COL64 NVARCHAR(MAX),
			COL65 NVARCHAR(MAX),
			COL66 NVARCHAR(MAX),
			COL67 NVARCHAR(MAX),
			COL68 NVARCHAR(MAX),
			COL69 NVARCHAR(MAX),
			COL70 NVARCHAR(MAX),
			COL71 NVARCHAR(MAX),
			COL72 NVARCHAR(MAX),
			COL73 NVARCHAR(MAX),
			COL74 NVARCHAR(MAX),
			COL75 NVARCHAR(MAX),
			COL76 NVARCHAR(MAX),
			COL77 NVARCHAR(MAX),
			COL78 NVARCHAR(MAX),
			COL79 NVARCHAR(MAX),
			COL80 NVARCHAR(MAX),
			COL81 NVARCHAR(MAX),
			COL82 NVARCHAR(MAX),
			COL83 NVARCHAR(MAX),
			COL84 NVARCHAR(MAX),
			COL85 NVARCHAR(MAX),
			COL86 NVARCHAR(MAX),
			COL87 NVARCHAR(MAX),
			COL88 NVARCHAR(MAX),
			COL89 NVARCHAR(MAX),
			COL90 NVARCHAR(MAX),
			COL91 NVARCHAR(MAX),
			COL92 NVARCHAR(MAX),
			COL93 NVARCHAR(MAX),
			COL94 NVARCHAR(MAX),
			COL95 NVARCHAR(MAX),
			COL96 NVARCHAR(MAX),
			COL97 NVARCHAR(MAX),
			COL98 NVARCHAR(MAX),
			COL99 NVARCHAR(MAX),
			COL100 NVARCHAR(MAX),
			COL101 NVARCHAR(MAX),
			COL102 NVARCHAR(MAX),
			COL103 NVARCHAR(MAX),
			COL104 NVARCHAR(MAX),
			COL105 NVARCHAR(MAX),
			COL106 NVARCHAR(MAX),
			COL107 NVARCHAR(MAX),
			COL108 NVARCHAR(MAX),
			COL109 NVARCHAR(MAX),
			COL110 NVARCHAR(MAX),
			COL111 NVARCHAR(MAX),
			COL112 NVARCHAR(MAX),
			COL113 NVARCHAR(MAX),
			COL114 NVARCHAR(MAX),
			COL115 NVARCHAR(MAX),
			COL116 NVARCHAR(MAX),
			COL117 NVARCHAR(MAX),
			COL118 NVARCHAR(MAX),
			COL119 NVARCHAR(MAX),
			COL120 NVARCHAR(MAX),
			COL121 NVARCHAR(MAX),
			COL122 NVARCHAR(MAX),
			COL123 NVARCHAR(MAX),
			COL124 NVARCHAR(MAX),
			COL125 NVARCHAR(MAX),
			COL126 NVARCHAR(MAX),
			COL127 NVARCHAR(MAX),
			COL128 NVARCHAR(MAX),
			COL129 NVARCHAR(MAX),
			COL130 NVARCHAR(MAX),
			COL131 NVARCHAR(MAX),
			COL132 NVARCHAR(MAX),
			COL133 NVARCHAR(MAX),
			COL134 NVARCHAR(MAX),
			COL135 NVARCHAR(MAX),
			COL136 NVARCHAR(MAX),
			COL137 NVARCHAR(MAX),
			COL138 NVARCHAR(MAX),
			COL139 NVARCHAR(MAX),
			COL140 NVARCHAR(MAX),
			COL141 NVARCHAR(MAX),
			COL142 NVARCHAR(MAX),
			COL143 NVARCHAR(MAX),
			COL144 NVARCHAR(MAX),
			COL145 NVARCHAR(MAX),
			COL146 NVARCHAR(MAX),
			COL147 NVARCHAR(MAX),
			COL148 NVARCHAR(MAX),
			COL149 NVARCHAR(MAX),
			COL150 NVARCHAR(MAX),
			COL151 NVARCHAR(MAX),
			COL152 NVARCHAR(MAX),
			COL153 NVARCHAR(MAX),
			COL154 NVARCHAR(MAX),
			COL155 NVARCHAR(MAX),
			COL156 NVARCHAR(MAX),
			COL157 NVARCHAR(MAX),
			COL158 NVARCHAR(MAX),
			COL159 NVARCHAR(MAX),
			COL160 NVARCHAR(MAX),
			COL161 NVARCHAR(MAX),
			COL162 NVARCHAR(MAX),
			COL163 NVARCHAR(MAX),
			COL164 NVARCHAR(MAX),
			COL165 NVARCHAR(MAX),
			COL166 NVARCHAR(MAX),
			COL167 NVARCHAR(MAX),
			COL168 NVARCHAR(MAX),
			COL169 NVARCHAR(MAX),
			COL170 NVARCHAR(MAX),
			COL171 NVARCHAR(MAX),
			COL172 NVARCHAR(MAX),
			COL173 NVARCHAR(MAX),
			COL174 NVARCHAR(MAX),
			COL175 NVARCHAR(MAX),
			COL176 NVARCHAR(MAX),
			COL177 NVARCHAR(MAX),
			COL178 NVARCHAR(MAX),
			COL179 NVARCHAR(MAX),
			COL180 NVARCHAR(MAX),
			COL181 NVARCHAR(MAX),
			COL182 NVARCHAR(MAX),
			COL183 NVARCHAR(MAX),
			COL184 NVARCHAR(MAX),
			COL185 NVARCHAR(MAX),
			COL186 NVARCHAR(MAX),
			COL187 NVARCHAR(MAX),
			COL188 NVARCHAR(MAX),
			COL189 NVARCHAR(MAX),
			COL190 NVARCHAR(MAX),
			COL191 NVARCHAR(MAX),
			COL192 NVARCHAR(MAX),
			COL193 NVARCHAR(MAX),
			COL194 NVARCHAR(MAX),
			COL195 NVARCHAR(MAX),
			COL196 NVARCHAR(MAX),
			COL197 NVARCHAR(MAX),
			COL198 NVARCHAR(MAX),
			COL199 NVARCHAR(MAX),
			COL200 NVARCHAR(MAX)
		)

		CREATE TABLE #ColumnName(
			Id INT PRIMARY KEY IDENTITY(1,1),
			Column_Name NVARCHAR(MAX)
		)

		IF @CallFor = 'INS'
		BEGIN
				INSERT INTO DM_Booking_Sheet_Data (DM_Master_Import_Code, Sheet_Name, Data_Type, Col1  ,Col2 ,Col3 ,Col4 ,Col5 ,Col6 ,Col7 ,Col8 ,Col9 ,Col10 ,Col11 ,Col12 ,Col13 ,Col14 ,Col15 ,Col16 ,Col17 ,Col18 ,Col19 ,Col20 ,Col21 ,Col22 ,Col23 ,Col24 ,Col25 ,Col26 ,Col27 ,Col28 ,Col29 ,Col30 ,Col31 ,Col32 ,Col33 ,Col34 ,Col35 ,Col36 ,Col37 ,Col38 ,Col39 ,Col40 ,Col41 ,Col42 ,Col43 ,Col44 ,Col45 ,Col46 ,Col47 ,Col48 ,Col49 ,Col50 ,Col51 ,Col52 ,Col53 ,Col54 ,Col55 ,Col56 ,Col57 ,Col58 ,Col59 ,Col60 ,Col61 ,Col62 ,Col63 ,Col64 ,Col65 ,Col66 ,Col67 ,Col68 ,Col69 ,Col70 ,Col71 ,Col72 ,Col73 ,Col74 ,Col75 ,Col76 ,Col77 ,Col78 ,Col79 ,Col80 ,Col81 ,Col82 ,Col83 ,Col84 ,Col85 ,Col86 ,Col87 ,Col88 ,Col89 ,Col90 ,Col91 ,Col92 ,Col93 ,Col94 ,Col95 ,Col96 ,Col97 ,Col98 ,Col99 ,Col100 ,
				                                  COL101, COL102, COL103, COL104, COL105, COL106, COL107, COL108, COL109, COL110, COL111, COL112, COL113, COL114, COL115, COL116, COL117, COL118, COL119, COL120, COL121, COL122, COL123, COL124, COL125, COL126, COL127, COL128, COL129, COL130, COL131, COL132, COL133, COL134, COL135, COL136, COL137, COL138, COL139, COL140, COL141, COL142, COL143, COL144, COL145, COL146, COL147, COL148, COL149, COL150, COL151, COL152, COL153, COL154, COL155, COL156, COL157, COL158, COL159, COL160, COL161, COL162, COL163, COL164, COL165, COL166, COL167, COL168, COL169, COL170, COL171, COL172, COL173, COL174, COL175, COL176, COL177, COL178, COL179, COL180, COL181, COL182, COL183, COL184, COL185, COL186, COL187, COL188, COL189, COL190, COL191, COL192, COL193, COL194, COL195, COL196, COL197, COL198, COL199)
				SELECT @DM_Master_Import_Code, @Sheet_Name, Col1 , Col2 ,Col3 ,Col4 ,Col5 ,Col6 ,Col7 ,Col8 ,Col9 ,Col10 ,Col11 ,Col12 ,Col13 ,Col14 ,Col15 ,Col16 ,Col17 ,Col18 ,Col19 ,Col20 ,Col21 ,Col22 ,Col23 ,Col24 ,Col25 ,Col26 ,Col27 ,Col28 ,Col29 ,Col30 ,Col31 ,Col32 ,Col33 ,Col34 ,Col35 ,Col36 ,Col37 ,Col38 ,Col39 ,Col40 ,Col41 ,Col42 ,Col43 ,Col44 ,Col45 ,Col46 ,Col47 ,Col48 ,Col49 ,Col50 ,Col51 ,Col52 ,Col53 ,Col54 ,Col55 ,Col56 ,Col57 ,Col58 ,Col59 ,Col60 ,Col61 ,Col62 ,Col63 ,Col64 ,Col65 ,Col66 ,Col67 ,Col68 ,Col69 ,Col70 ,Col71 ,Col72 ,Col73 ,Col74 ,Col75 ,Col76 ,Col77 ,Col78 ,Col79 ,Col80 ,Col81 ,Col82 ,Col83 ,Col84 ,Col85 ,Col86 ,Col87 ,Col88 ,Col89 ,Col90 ,Col91 ,Col92 ,Col93 ,Col94 ,Col95 ,Col96 ,Col97 ,Col98 ,Col99 ,Col100 ,
				       COL101, COL102, COL103, COL104, COL105, COL106, COL107, COL108, COL109, COL110, COL111, COL112, COL113, COL114, COL115, COL116, COL117, COL118, COL119, COL120, COL121, COL122, COL123, COL124, COL125, COL126, COL127, COL128, COL129, COL130, COL131, COL132, COL133, COL134, COL135, COL136, COL137, COL138, COL139, COL140, COL141, COL142, COL143, COL144, COL145, COL146, COL147, COL148, COL149, COL150, COL151, COL152, COL153, COL154, COL155, COL156, COL157, COL158, COL159, COL160, COL161, COL162, COL163, COL164, COL165, COL166, COL167, COL168, COL169, COL170, COL171, COL172, COL173, COL174, COL175, COL176, COL177, COL178, COL179, COL180, COL181, COL182, COL183, COL184, COL185, COL186, COL187, COL188, COL189, COL190, COL191, COL192, COL193, COL194, COL195, COL196, COL197, COL198, COL199, COL200
				FROM @Booking_Sheet_Utility
		END		

		SELECT @Result AS 'Result'
		IF(OBJECT_ID('tempdb..#Temp_DM_TIUD') IS NOT NULL) DROP TABLE #Temp_DM_TIUD
		IF(OBJECT_ID('tempdb..#ColumnName') IS NOT NULL) DROP TABLE #ColumnName
	 
	if(@Loglevel< 2)Exec [USPLogSQLSteps] '[USPAL_Booking_Sheet_Import_Utility_PI]', 'Step 2', 0, 'Procedure Excuting Completed', 0, '' 
END