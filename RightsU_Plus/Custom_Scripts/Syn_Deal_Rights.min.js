function OnTabChange(n){showLoading();n=="HB"?(TabType="HB",Bind_Holdback(),$("#btnAddSD").show()):(n=="BO"?(TabType="BO",$("#btnAddSD").show()):(TabType="RR",$("#btnAddSD").hide()),Bind_BlackOut());hideLoading()}function CheckIfHoldbackExistAcq(){var n=$("#tabHoldback .grid_item").html();n!=undefined&&$.ajax({type:"POST",url:URL_CheckHBWithAcq,data:$("#frmRights").serialize(),success:function(n){return n=="true"&&redirectToLogin(),!1},error:function(n){return alert("Error: "+n.responseText),hideLoading(),!1}})}function Bind_Holdback(){$.ajax({type:"POST",url:URL_BindHoldback,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",dataType:"html",success:function(n){n=="true"&&redirectToLogin();$("#tabHoldback").html(n);$("#trAddEdit")!=null&&$("#trAddEdit")!=undefined&&$("#trAddEdit").hide();initializeExpander();initializeTooltip()},error:function(n){alert("Error: "+n.responseText);hideLoading()}})}function Bind_BlackOut(){$("#hdnEditRecord").val("");$.ajax({type:"POST",url:URL_BindBlackOut,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",dataType:"html",success:function(n){n=="true"&&redirectToLogin();$("#tabBlackout").html(n);$("#trAddEditBO")!=null&&$("#trAddEditBO")!=undefined&&$("#trAddEditBO").hide();initializeTooltip()},error:function(n){alert("Error: "+n.responseText);hideLoading()}})}function Add_Holdback_Blackout(){var w,n,i,tt,t,r,a,v,it,f,rt,e,u,c,p,o,ut,s,ft,h,et;if($("#hdnEditRecord").val()==""){n=!0;$(".required").removeClass("required");$("[required='required']").removeAttr("required");var k=$("#hdnTitle_Code"),d=$("#hdnRegion_Code"),g=$("#hdnDub_Code"),nt=$("#hdnSub_Code");if(k.val(""),d.val(""),g.val(""),nt.val(""),w="",$("#lbTitles").val()!=null&&(w=$("#lbTitles").val().join(",")),k.val(w),n=!0,w==""&&(n=!1,$("#lbTitles").attr("required",!0)),$("#hdnTVCodes").val()==""&&(n=!1,$("#tree").attr("required",!0),$("#tree").addClass("required")),i="",tt=$("#rdoCountryHB").prop("checked")?$("#rdoCountryHB").val():$("#rdoTerritoryHB").val(),$("#hdnRegion_Type").val(tt),$("#lbTerritory option:selected").length>0&&$("#lbTerritory option:selected").each(function(){i=i==""?$(this).val():i+","+$(this).val()}),d.val(i),i==""&&(n=!1,$("#lbTerritory").attr("required",!0)),t="",r=$("#Right_Type").val(),r==YearBased){var u=$("#Start_Date"),c=$("#End_Date"),l=!1;$("#Is_Tentative").prop("checked")&&(l=!0);u.val()==""&&(n=!1,$("#Start_Date").attr("required",!0));c.val()==""&&l==!1&&(n=!1,$("#End_Date").attr("required",!0));u.val()!=""&&c.val()!=""&&compareDates_DMY(u.val(),c.val())<0&&(n=!1,$("#Start_Date").attr("required",!0),$("#End_Date").attr("required",!0),txtROFRDays.val(""),t="Start Date should be less than end date.");a=$("#Term_YY").val();v=$("#Term_MM").val();l==!0&&(a==null||a=="0"||a==undefined||a=="")&&(v==null||v=="0"||v==undefined||v=="")&&(n=!1,showAlert("E","Please enter valid Term"))}else r==Perpetuity&&($("#txtPerpetuity_Date").val()==""||$("#txtPerpetuity_Date").val()=="DD/MM/YYYY")&&(n=!1,$("#txtPerpetuity_Date").attr("required",!0));if(it=$("#rdoDubbingL").prop("checked")?$("#rdoDubbingL").val():$("#rdoDubbingLG").val(),$("#hdnDub_Type").val(it),f="",$("#lbDub_Language option:selected").length>0&&$("#lbDub_Language option:selected").each(function(){f=f==""?$(this).val():f+","+$(this).val()}),g.val(f),rt=$("#rdoSubL").prop("checked")?$("#rdoSubL").val():$("#rdoSubLG").val(),$("#hdnSub_Type").val(rt),e="",$("#lbSub_Language option:selected").length>0&&$("#lbSub_Language option:selected").each(function(){e=e==""?$(this).val():e+","+$(this).val()}),nt.val(e),$("#Is_Title_Language_Right").prop("checked")==!1&&e==""&&f==""&&(n=!1,$("#lbTerritory").attr("required",!0),t!=""&&(t=t+"<\/br>"),t=t+"Please select atleast one language."),n||$.trim(t)==""||showAlert("E",t),n){var r=$("#Right_Type").val(),b="",l="No",y="";return r==YearBased?(u=$("#Start_Date"),c=$("#End_Date"),$("#Is_Tentative").prop("checked")?(l="Yes",b=MakeDateFormate(u.val())):b=MakeDateFormate(u.val())+" To "+MakeDateFormate(c.val()),y=$("#Term_YY").val()+" Year",$("#Term_MM").val()!=0&&(y=y+$("#Term_MM").val()+" Month")):r==Perpetuity&&$("#txtPerpetuity_Date").val()!=""&&$("#txtPerpetuity_Date").val()!="DD/MM/YYYY"&&(b=MakeDateFormate($("#txtPerpetuity_Date").val()),y="Perpetuity"),TabType=="HB"?(p=$("#rdoCountryHB").prop("checked")?$("#rdoCountryHB").val():$("#rdoTerritoryHB").val(),p=p=="G"?"T":p,o="",$("#lbTerritory option:selected").length>0&&$("#lbTerritory option:selected").each(function(){o=o==""?$(this).val():o+","+$(this).val()}),ut=$("#rdoSubL").prop("checked")?$("#rdoSubL").val():$("#rdoSubLG").val(),s="",$("#lbSub_Language option:selected").length>0&&$("#lbSub_Language option:selected").each(function(){s=s==""?$(this).val():s+","+$(this).val()}),ft=$("#rdoDubbingL").prop("checked")?$("#rdoDubbingL").val():$("#rdoDubbingLG").val(),h="",$("#lbDub_Language option:selected").length>0&&$("#lbDub_Language option:selected").each(function(){h=h==""?$(this).val():h+","+$(this).val()}),et=$("#lbTitles option:selected").map(function(){return $(this).text()}).get().join(),showLoading(),$.ajax({type:"POST",url:URL_Add_Holdback,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",dataType:"html",data:JSON.stringify({R_Type:p,SL_Type:ut,DL_Type:ft,R_Code:o,SL_Code:s,DL_Code:h,Titles:et,Period:b,IsTentative:l,PeriodTerm:y,strPlatform:$("#hdnTVCodes").val()}),success:function(n){var o;if(n=="true"&&redirectToLogin(),$("#popEditHB").html(n),initializeChosen(),initializeDatepicker(),r==YearBased){var t=$("#Term_YY"),i=$("#Term_MM"),s=new Date(MakeDateFormate(u.val())),f=0,e=0;t.val()!=""&&(f=parseInt(t.val()));i.val()!=""&&(e=parseInt(i.val()));o=CalculateEndDate(s,f,e);$("#Is_Tentative").prop("checked")?setMinMaxDates("Holdback_Release_Date",$("#Start_Date").val(),o):setMinMaxDates("Holdback_Release_Date",$("#Start_Date").val(),$("#End_Date").val())}else r==Perpetuity&&setMinMaxDates("Holdback_Release_Date",$("#txtPerpetuity_Date").val(),"");hideLoading();$("#popEditHB").modal()},error:function(n){alert("Error: "+n.responseText)}})):TabType=="BO"&&($("#hdnEditRecord").val("Add"),$.ajax({type:"POST",url:URL_Add_Blackout,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",dataType:"html",data:JSON.stringify({}),success:function(n){n=="true"&&redirectToLogin();$('a[href="#tabHoldback"]').prop("disabled",!0);$('a[href="#tabRestriction"]').prop("disabled",!0);$("#tabBlackout").html(n);$("#trAddEditBO").show();initializeChosen();initializeDatepicker();hideLoading()},error:function(n){alert("Error: "+n.responseText)}})),!0}return!1}showAlert("E","Please complete Add/Edit operation first")}function BindDropdown(n,t){var r;r="";$("#lbTitles").val()!=null&&(r=$("#lbTitles").val().join(","));var e=$("#hdnTVCodes").val(),o=$("#rdoCountryHB").prop("checked")?"I":"T",s=$("#rdoSubL").prop("checked")?"SL":"SG",h=$("#rdoDubbingL").prop("checked")?"DL":"DG",i="",u=$("#Is_Theatrical_Right").prop("checked");u=u?"Y":"N";n=="I"||n=="T"?i="lbTerritory":n=="DL"||n=="DG"?i="lbDub_Language":(n=="SL"||n=="SG")&&(i="lbSub_Language");var f="";t=="PF"&&(f=$("#"+i).val());$.ajax({type:"POST",url:URL_Bind_JSON_ListBox,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",async:!0,data:JSON.stringify({str_Type:n,Is_Thetrical:u,titleCodes:r,platformCodes:e,Region_Type:o,rdbSubtitlingLanguage:s,rdbDubbingLanguage:h}),success:function(t){if(t=="true"&&redirectToLogin(),t=="Holdback is already added.")n=="I"?$("#rdoTerritoryHB").prop("checked",!0):n=="T"?$("#rdoCountryHB").prop("checked",!0):n=="DL"?$("#rdoDubbingLG").prop("checked",!0):n=="DG"?$("#rdoDubbingL").prop("checked",!0):n=="SL"?$("#rdoSubLG").prop("checked",!0):n=="SG"&&$("#rdoSubL").prop("checked",!0),showAlert("E",t);else{if(n=="A"){var r=$("#lbTerritory").val(),u=$("#lbSub_Language").val(),e=$("#lbDub_Language").val();$("#lbTerritory,#lbSub_Language,#lbDub_Language").empty()}else $("#"+i).empty();$(t.USP_Result).each(function(){this.Data_For=="RGN"?$("#lbTerritory").append($("<option>").val(this.Display_Value).text(this.Display_Text)):this.Data_For=="SL"?$("#lbSub_Language").append($("<option>").val(this.Display_Value).text(this.Display_Text)):this.Data_For=="DL"&&$("#lbDub_Language").append($("<option>").val(this.Display_Value).text(this.Display_Text))});n=="A"?($("#lbTerritory").val(r).trigger("chosen:updated"),$("#lbSub_Language").val(u).trigger("chosen:updated"),$("#lbDub_Language").val(e).trigger("chosen:updated")):$("#"+i).val(f).trigger("chosen:updated");i=="lbTerritory"&&fillTotal()}},error:function(n){showAlert("E","Error: "+n.responseText)}})}function BindListandDdl(){$.ajax({type:"POST",url:URL_Bind_JSON_ListBox,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",async:!0,data:JSON.stringify({str_Type:"DR",Is_Thetrical:$("#Is_Theatrical_Right").prop("checked"),titleCodes:"",platformCodes:"",Region_Type:"",rdbSubtitlingLanguage:"",rdbDubbingLanguage:""}),success:function(n){n=="true"?redirectToLogin():($(n.USP_Result).each(function(){this.Data_For==null||this.Data_For==undefined||this.Data_For==""||(this.Data_For=="ROR"&&$("#ROFR_Code").append($("<option>").val(this.Display_Value).text(this.Display_Text)),this.Data_For=="SBL"&&$("#Sub_License_Code").append($("<option>").val(this.Display_Value).text(this.Display_Text)),this.Data_For=="TIT"&&$("#lbTitles").append($("<option>").val(this.Display_Value).text(this.Display_Text)),this.Data_For=="RGN"&&$("#lbTerritory").append($("<option>").val(this.Display_Value).text(this.Display_Text)),this.Data_For=="SL"&&$("#lbSub_Language").append($("<option>").val(this.Display_Value).text(this.Display_Text)),this.Data_For=="DL"&&$("#lbDub_Language").append($("<option>").val(this.Display_Value).text(this.Display_Text)))}),$("#ROFR_Code").val(n.Selected_ROR).attr("selected","true").trigger("chosen:updated"),$("#Sub_License_Code").val(n.Selected_SBL).attr("selected","true").trigger("chosen:updated"),$("#lbTitles").val(n.Selected_Tit_Code.split(",")).attr("selected","true").trigger("chosen:updated"),$("#lbTerritory").val(n.Selected_R_Code.split(",")).attr("selected","true").trigger("chosen:updated"),$("#lbSub_Language").val(n.Selected_SL_Code.split(",")).attr("selected","true").trigger("chosen:updated"),$("#lbDub_Language").val(n.Selected_DL_Code.split(",")).attr("selected","true").trigger("chosen:updated"),Is_Theatrical_Right_G!="Y"&&BindPlatform(),initializeTooltip(),SetTitleLanguage(),fillTotal())}})}function handleOk(){var t,n,i;MessageFrom=="SV"&&($("#hdnTabName").val()==""?BindPartialTabs(pageRights_List):(t=$("#hdnTabName").val(),BindPartialTabs(t)));$("#hdnCommandName").val()!=undefined&&$("#hdnCommandName").val()!=""&&$("#hdnCommandName").val()=="CANCEL"&&BindPartialTabs(pageRights_List);CommandName=="COPY_HB"&&(n=HB_Code,$.ajax({type:"POST",url:URL_CopyHoldbackFromAcq,data:{HoldbackCode:n.toString()},success:function(t){CommandName="";t=="true"&&redirectToLogin();$('#tabRights a[href="#tabHoldback"]').trigger("click");$("#hdnHB_Code").val(n.toString());BindPlatform()},error:function(){}}));$("#dummyProperty")!=null&&$("#dummyProperty").val()!=undefined&&$("#dummyProperty").val()!=""&&(showLoading(),i=$("#dummyProperty").val(),$.ajax({type:"POST",url:URL_Delete_Holdback,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",dataType:"html",data:JSON.stringify({DummyProperty:i}),success:function(n){n=="true"&&redirectToLogin();$("#dummyProperty").val("");Bind_Holdback();$("#Is_Theatrical_Right").prop("checked")==!1&&BindPlatform();hideLoading();showAlert("S","Holdback deleted successfully")},error:function(n){hideLoading();alert("Error: "+n.responseText)}}));$("#hdnDummyProp")!=null&&$("#hdnDummyProp").val()!=undefined&&$("#hdnDummyProp").val()!=""&&$.ajax({type:"POST",url:URL_Delete_Blackout,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",dataType:"html",data:JSON.stringify({DummyProperty:$("#hdnDummyProp").val()}),success:function(n){n=="true"&&redirectToLogin();$("#tabBlackout").html(n);initializeDatepicker()},error:function(n){alert("Error: "+n.responseText)}})}function CheckHBRegionWithRightsRegion(){var i,n,t;return $("#lbTerritory option:selected").prop("disabled",!1),$("#lbTerritory option").removeAttr("disabled"),i=$("#rdoCountryHB").prop("checked")?$("#rdoCountryHB").val():$("#rdoTerritoryHB").val(),n="",$("#lbTerritory option:selected").length>0&&$("#lbTerritory option:selected").each(function(){n=n==""?$(this).val():n+","+$(this).val()}),t="Valid",$.ajax({type:"POST",url:URL_CheckHBRegionWithRightsRegion,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",data:JSON.stringify({region_type:i,region_Code:n}),async:!1,success:function(n){n=="true"&&redirectToLogin();t=n},error:function(n){hideLoading();alert("Error Validate_Save_Holdback: "+n.responseText)}}),t}function CheckHBSubtitleRegionWithRightsSubtitle(){$("#lbSub_Language option:selected").prop("disabled",!1);$("#lbSub_Language option").removeAttr("disabled");var i=$("#rdoSubL").prop("checked")?$("#rdoSubL").val():$("#rdoSubLG").val(),n="",t="Valid";return $("#lbSub_Language option:selected").length>0&&$("#lbSub_Language option:selected").each(function(){n=n==""?$(this).val():n+","+$(this).val()}),$.ajax({type:"POST",url:URL_CheckHBSubtitleWithRightsSubtitle,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",data:JSON.stringify({Subtitle_type:i,Subtitle_Code:n}),async:!1,success:function(n){n=="true"&&redirectToLogin();t=n},error:function(n){hideLoading();alert("Error Validate_Save_Holdback: "+n.responseText)}}),t}function CheckHBDubbingWithRightsDubbing(){var i,n,t;return $("#lbDub_Language option:selected").prop("disabled",!1),$("#lbDub_Language option").removeAttr("disabled"),i=$("#rdoDubbingL").prop("checked")?$("#rdoDubbingL").val():$("#rdoDubbingLG").val(),n="",$("#lbDub_Language option:selected").length>0&&$("#lbDub_Language option:selected").each(function(){n=n==""?$(this).val():n+","+$(this).val()}),t="Valid",$.ajax({type:"POST",url:URL_CheckHBDubbingWithRightsDubbing,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",data:JSON.stringify({Dubbing_type:i,Dubbing_Code:n}),async:!1,success:function(n){n=="true"&&redirectToLogin();t=n},error:function(n){hideLoading();alert("Error Validate_Save_Holdback: "+n.responseText)}}),t}function SetMaxDt(){setMinMaxDates("Start_Date","",$("#End_Date").val());Set_MinMax_ROFR()}function SetMinDt(){setMinMaxDates("End_Date",$("#Start_Date").val(),"");Set_MinMax_ROFR()}function Set_MinMax_ROFR(){var n;if($("#End_Date").val()!="")setMinMaxDates("ROFR_DT",$("#Start_Date").val(),$("#End_Date").val());else{var r=$("#Term_YY"),u=$("#Term_MM"),o=$("#ROFR_DT"),f=$("#Start_Date"),e=new Date(MakeDateFormate(f.val())),t=0,i=0;r.val()!=""&&(t=parseInt(r.val()));u.val()!=""&&(i=parseInt(u.val()));n=CalculateEndDate(e,t,i);n!=undefined&&n!=""&&$("#Start_Date").val()!=""&&(t>0||i>0)&&setMinMaxDates("ROFR_DT",$("#Start_Date").val(),n)}}function Show_Validation_Popup(n,t,i){$.ajax({type:"POST",url:URL_Show_Validation_Popup,traditional:!0,async:!1,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",data:JSON.stringify({searchForTitles:n,PageSize:t,PageNo:i}),success:function(n){n=="true"&&redirectToLogin();$("#BindValidationPopup").html(n)},error:function(){}});$("#popupValidationError").modal();initializeChosen();setChosenWidth("#lbSearchTitles","500px");initializeExpander()}function SetTheatrical(n){var r="N",u=!1,f=!1,h=$("#hdnTVCodes").val(),o=$("#lbTerritory").val(),t="",s="uncheck",e,i;if(h!=""&&(u=!0,t="Platform"),o!=""&&o!=null&&(u=!0,t!=""&&(t+=", "),t+="Region"),$("#Is_Theatrical_Right").prop("checked")==!0&&(s="check",f=!0),u&&n=="C"&&(t="Are you sure you want to "+s+"? All selected "+t+" will get cleared, do you still want to continue?",!confirm(t)))return $("#Is_Theatrical_Right").prop("checked",!f),!1;f?(e="",$("#lbTitles").val()!=null&&(e=$("#lbTitles").val().join(",")),$.ajax({type:"POST",url:URL_CheckTheatrical,traditional:!0,async:!1,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",data:JSON.stringify({titleCodes:e}),success:function(n){n=="true"&&redirectToLogin();$("#lblTheatrical").hide();$("#"+TreeId_G).hide();$("#hdnTVCodes").val("");n==Theatrical_Platform_Code_G&&($("#lblCountry").text("Circuit"),$("#lblTheatrical").show(),$("#hdnTVCodes").val(Theatrical_Platform_Code_G),r="Y",$("#tree").removeClass("required"));TreeViewSelectedChange($("#Is_Theatrical_Right"))},error:function(n){alert(n.responseText)}})):($("#lblTheatrical").hide(),$("#lblCountry").text("Country"),$("#hdnTVCodes").val(""),BindPlatform(),$("#"+TreeId_G).show(),r="N");i=$("#rdoCountryHB").prop("checked")?$("#rdoCountryHB").val():$("#rdoTerritoryHB").val();i=i=="G"?"T":i;ClearHoldbackGrid(r);BindDropdown(i,"");Bind_Holdback()}function ClearHoldbackGrid(n){$.ajax({type:"POST",url:URL_ClearHoldbackGrid,traditional:!0,async:!1,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",data:JSON.stringify({Is_Theatrical:n}),success:function(n){n=="true"&&redirectToLogin()},error:function(n){alert(n.responseText)}})}function SetRightPeriod(n){if(n==YearBased&&$('#tabValidity a[href="#tabCal"]').prop("disabled")||n==Perpetuity&&$('#tabValidity a[href="#tabPerp"]').prop("disabled"))return!1;$("#Right_Type").val(n);n!=YearBased?($("#ROFR_DT").prop("disabled",!0),$("#ROFR_Days").prop("disabled",!0),$("#ROFR_DT").val(""),$("#ROFR_Days").val(""),n==Perpetuity?$("#ROFR_Code").prop("disabled",!0):$("#ROFR_Code").prop("disabled",!1)):($("#ROFR_DT").prop("disabled",!1),$("#ROFR_Days").prop("disabled",!1),$("#ROFR_Code").prop("disabled",!1));$("#ROFR_Code").trigger("chosen:updated")}function OnClickTentative(){var n=!1;$("#Is_Tentative").prop("checked")&&(n=!0);n?($("#End_Date").prop("disabled",!0),$("#End_Date").val("")):($("#End_Date").prop("disabled",!1),OnFocusLostTerm())}function CalculateROFRDate(){var r=$("#Start_Date"),s=$("#End_Date"),h=$("#Term_YY"),c=$("#Term_MM"),t=$("#ROFR_DT"),n=$("#ROFR_Days"),i,l=!1,e,o,u,f,a,v,y;if(n.val()==""||n.val()=="0")return n.val("0"),t.val(""),!1;if($("#Is_Tentative").prop("checked")&&(l=!0),e=$("#Right_Type").val(),e==YearBased)if(l)if(r.val()!=""){if(o=new Date(MakeDateFormate(r.val())),isNaN(o))return showAlert("E","Start date is not in proper format."),!1;u=0;f=0;h.val()!=""&&(u=parseInt(h.val()));c.val()!=""&&(f=parseInt(c.val()));(u>0||f>0)&&(a=CalculateEndDate(o,u,f),i=new Date(MakeDateFormate(a)))}else return showAlert("E","Please select start date."),!1;else{if(s.val()=="")return n.val(""),showAlert("E","Please select end date."),!1;i=new Date(MakeDateFormate(s.val()))}return(isNaN(n.val())||n.val()=="")&&(n.val()="0"),n.val()!=""&&(v=parseInt(n.val()),i.setDate(i.getDate()-v),y=ConvertDateToCurrentFormat(i),t.val(y),e==YearBased&&r.val()!=""&&t.val()!=""&&compareDates_DMY(r.val(),t.val())<0)?(showAlert("E","Please enter valid Refusal Days so that Refusal Date greater than or equal to Start Date","ROFR_Days"),n.val("0"),t.val(""),!1):void 0}function CalculateROFRDays(){var t=$("#Start_Date"),h=$("#End_Date"),c=$("#Term_YY"),l=$("#Term_MM"),n=$("#ROFR_DT"),i=$("#ROFR_Days"),a=$("#Right_Type").val(),f="",e="",o,s,r,u,v,y,p;if(n.val()=="")return i.val("0"),!1;if(n.val()!=""&&(e=new Date(MakeDateFormate(n.val())),isNaN(e)))return showAlert("E","ROFR date is not in proper format.","ROFR_DT"),!1;if(o=!1,$("#Is_Tentative").prop("checked")&&(o=!0),a==YearBased)if(o)if(t.val()!=""){if(s=new Date(MakeDateFormate(t.val())),isNaN(s))return showAlert("E","Start date is not in proper format."),!1;r=0;u=0;c.val()!=""&&(r=parseInt(c.val()));l.val()!=""&&(u=parseInt(l.val()));(r>0||u>0)&&(v=CalculateEndDate(s,r,u),f=new Date(MakeDateFormate(v)))}else return showAlert("E","Please select start date."),!1;else{if(h.val()=="")return i.val(""),showAlert("E","Please select end date."),!1;f=new Date(MakeDateFormate(h.val()))}return y=new Date(f-e),p=y/864e5,i.val(p),a==YearBased&&t.val()!=""&&n.val()!=""&&compareDates_DMY(t.val(),n.val())<0?(showAlert("E","Please enter valid Refusal Days so that Refusal Date greater than or equal to Start Date","ROFR_DT"),i.val("0"),n.val(""),!1):void 0}function OnFocusLostTerm(){var h=!0,o,s,i,r,e;$("#Is_Tentative").prop("checked")&&(h=!1);var f=$("#Start_Date"),u=$("#End_Date"),n=$("#Term_YY"),t=$("#Term_MM");(n.val()==""||isNaN(n.val()))&&n.val("0");(t.val()==""||isNaN(t.val()))&&t.val("0");f.val()!=""?(o=new Date(MakeDateFormate(f.val())),isNaN(o)||(i=0,r=0,n.val()!=""&&(i=parseInt(n.val())),t.val()!=""&&(r=parseInt(t.val())),i>0||r>0?(e=CalculateEndDate(o,i,r),h?u.val(e):u.val("")):u.val(""))):u.val()!=""?(s=new Date(MakeDateFormate(u.val())),isNaN(s)||(i=0,r=0,n.val()!=""&&(i=parseInt(n.val())),t.val()!=""&&(r=parseInt(t.val())),i>0||r>0?(e=CalculateStartDate(s,i,r),f.val(e)):f.val(""))):(n.val("0"),t.val("0"));CalculateROFRDate()}function OnFocusLostDate(){var u=!1,h=!0,t=$("#Start_Date"),i=$("#End_Date"),f=$("#Term_YY"),e=$("#Term_MM"),s,o,r,n;if($("#Is_Tentative").prop("checked")&&(h=!1),t.val()==""&&f.val()=="0"&&e.val()=="0"&&(u=!0),i.val()==""&&f.val()=="0"&&e.val()=="0"&&(u=!0),!u)if(t.val()!=""&&i.val()!=""){if(r=new Date(MakeDateFormate(t.val())),n=new Date(MakeDateFormate(i.val())),isNaN(r)||isNaN(n))return isNaN(r)&&(showAlert("E","Start Date is not valid","Start_Date"),t.val("")),isNaN(n)&&(showAlert("E","End Date is not valid","End_Date"),i.val("")),!1;n.setDate(n.getDate()+1);s=CalculateTerm(r,n);o=s.split(".");f.val(o[0]);e.val(o[1])}else t.val()!=""?(r=new Date(MakeDateFormate(t.val())),isNaN(r)?(showAlert("E","Start Date is not valid","Start_Date"),t.val("")):OnFocusLostTerm()):i.val()!=""&&(n=new Date(MakeDateFormate(i.val())),isNaN(n)?(showAlert("E","End Date is not valid","End_Date"),i.val("")):OnFocusLostTerm())}function CalculateEndDate(n,t,i){var r=12*t;return i=i+r,n.setMonth(n.getMonth()+i),n.setDate(n.getDate()-1),ConvertDateToCurrentFormat(n)}function CalculateStartDate(n,t,i){var r=12*t;return i=i+r,n.setMonth(n.getMonth()-i),n.setDate(n.getDate()+1),ConvertDateToCurrentFormat(n)}function ConvertDateToCurrentFormat(n){var t=n.getDate(),i=n.getMonth()+1,r=n.getFullYear();return t<10&&(t="0"+t),i<10&&(i="0"+i),t+"/"+i+"/"+r}function CalculateMonthBetweenTwoDate(n,t){var i=(t.getFullYear()-n.getFullYear())*12;return i+=t.getMonth()-n.getMonth(),t.getDate()<n.getDate()&&i--,i}function SetTitleLanguage(){if($("#lbTitles").val()!=null){var n=$("#lbTitles").val().join(",");$.ajax({type:"POST",url:URL_GetTitleLanguageName,traditional:!0,async:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",data:JSON.stringify({selectedTitles:n}),success:function(n){n=="true"&&redirectToLogin();$("#Title_Language")[0].innerHTML="("+n+")"},error:function(){}})}else $("#Title_Language")[0].innerHTML="(-)"}function MakeDateFormate(n){var t,i;if(n!=null||n!=""){t=n.split("/");i=parseFloat(t[1]);switch(i){case 1:t[1]="Jan";break;case 2:t[1]="Feb";break;case 3:t[1]="Mar";break;case 4:t[1]="Apr";break;case 5:t[1]="May";break;case 6:t[1]="Jun";break;case 7:t[1]="Jul";break;case 8:t[1]="Aug";break;case 9:t[1]="Sep";break;case 10:t[1]="Oct";break;case 11:t[1]="Nov";break;case 12:t[1]="Dec"}return t[0]+"-"+t[1]+"-"+t[2]}return""}function checkTitleForPt(){$("#hdnTitle_Code").val("");var n="";return($("#lbTitles").val()!=null&&(n=$("#lbTitles").val().join(",")),$("#hdnTitle_Code").val(n),n=="")?(showAlert("E","Please select title","lbTitles"),!1):$("#hdnTVCodes").val()==""?(showAlert("E","Please select Platform"),!1):!0}function ClearHidden(){$("#hdnTabName").val("")}function ValidateSave(){var n,e,h,r,i,c,o,s,a,u,v,f,t,w,b,k,d,rt;n=!0;$("#hdnEditRecord").val()!=""&&(n=!1,showAlert("E","Please complete Add/Edit operation first"));$(".required").removeClass("required");$("[required='required']").removeAttr("required");var g=$("#hdnTitle_Code"),nt=$("#hdnRegion_Code"),tt=$("#hdnDub_Code"),it=$("#hdnSub_Code");if(g.val(""),nt.val(""),tt.val(""),it.val(""),e="",$("#lbTitles").val()!=null&&(e=$("#lbTitles").val().join(",")),g.val(e),e==""&&(n=!1,$("#lbTitles").attr("required",!0)),$("#hdnTVCodes").val()==""&&(n=!1,$("#tree").attr("required",!0),$("#tree").addClass("required")),h=$("#rdoCountryHB").prop("checked")?$("#rdoCountryHB").val():$("#rdoTerritoryHB").val(),$("#hdnRegion_Type").val(h),r="",$("#lbTerritory option:selected").length>0&&$("#lbTerritory option:selected").each(function(){r=r==""?$(this).val():r+","+$(this).val()}),nt.val(r),$("input[type=radio][name=rdoSublicensing]:checked").val()==undefined?(n=!1,$("#divSublicensingOptions").addClass("required")):$("input[type=radio][name=rdoSublicensing]:checked").val()=="Y"&&$("#Sub_License_Code").val()==null&&(n=!1,$("#Sub_License_Code").attr("required",!0)),r==""&&(n=!1,$("#lbTerritory").attr("required",!0)),i="",c=$("#Right_Type").val(),c==YearBased){var y=$("#Start_Date"),p=$("#End_Date"),l=!1;$("#Is_Tentative").prop("checked")&&(l=!0);y.val()==""&&(n=!1,$("#Start_Date").attr("required",!0));p.val()==""&&l==!1&&(n=!1,$("#End_Date").attr("required",!0));y.val()!=""&&p.val()!=""&&compareDates_DMY(y.val(),p.val())<0&&(n=!1,$("#Start_Date").attr("required",!0),$("#End_Date").attr("required",!0),txtROFRDays.val(""),i="Start Date should be less than end date.");o=$("#Term_YY").val();s=$("#Term_MM").val();l==!0&&(o==null||o=="0"||o==undefined||o=="")&&(s==null||s=="0"||s==undefined||s=="")&&(n=!1,showAlert("E","Please enter valid Term"))}else c==Perpetuity&&($("#txtPerpetuity_Date").val()==""||$("#txtPerpetuity_Date").val()=="DD/MM/YYYY")&&(n=!1,$("#txtPerpetuity_Date").attr("required",!0));if(a=$("#rdoDubbingL").prop("checked")?$("#rdoDubbingL").val():$("#rdoDubbingLG").val(),$("#hdnDub_Type").val(a),u="",$("#lbDub_Language option:selected").length>0&&$("#lbDub_Language option:selected").each(function(){u=u==""?$(this).val():u+","+$(this).val()}),tt.val(u),v=$("#rdoSubL").prop("checked")?$("#rdoSubL").val():$("#rdoSubLG").val(),$("#hdnSub_Type").val(v),f="",$("#lbSub_Language option:selected").length>0&&$("#lbSub_Language option:selected").each(function(){f=f==""?$(this).val():f+","+$(this).val()}),it.val(f),$("#Is_Title_Language_Right").prop("checked")==!1&&f==""&&u==""&&(n=!1,$("#lbTerritory").attr("required",!0),i!=""&&(i=i+"<\/br>"),i=i+"Please select atleast one language."),n||$.trim(i)==""||showAlert("E",i),n){if(t="",t=CheckHBRegionWithRightsRegion(),t!="Valid")return t="Please select Region "+t+" as it is already selected in Holdback.",showAlert("E",t),!1;if(t=CheckHBSubtitleRegionWithRightsSubtitle(),t!="Valid")return t="Please select Subtitling language "+t+" as it is already selected in Holdback.",showAlert("E",t),!1;if(t=CheckHBDubbingWithRightsDubbing(),t!="Valid")return t="Please select Dubbing language "+t+" as it is already selected in Holdback.",showAlert("E",t),!1;if((h=="G"||a=="G"||v=="G")&&(w=r,h!="G"&&(w=""),b=u,a!="G"&&(b=""),k=f,v!="G"&&(k=""),d=ValidateGroups(w,b,k),d!=""))return showAlert("E",d),!1}return(msgSyn=Validate_Acq_Right_Title_Platform($("#hdnTVCodes").val(),e,c,l,$("#Start_Date").val(),$("#End_Date").val()),msgSyn!="")?(showAlert("E",msgSyn),!1):(n&&showLoading(),n&&(Dealmode_G==dealMode_View||Dealmode_G=="APRV")&&(rt=$("#hdnTabName").val(),BindPartialTabs(rt)),n)}function ValidateGroups(n,t,i){var r="";return $.ajax({type:"POST",url:URL_Validate_Groups,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify({Region_Codes:n,Dubbing_Codes:t,Subtitling_Codes:i}),success:function(n){n=="true"&&redirectToLogin();r=n},error:function(){}}),r}function Validate_After_Syndication(n,t,i,r,u,f,e,o,s,h,c){var l="";return $.ajax({type:"POST",url:URL_Validate_Acq_Rights_After_Syndication,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify({Tit_Codes:n,Reg_Type:t,Reg_Codes:i,Sub_Type:r,Sub_Codes:u,Dub_Type:f,Dub_Codes:e,Right_Type:o,Right_Start_Date:s,Right_End_Date:h,Perpetuity_Date:c}),success:function(n){n=="true"&&redirectToLogin();l=n},error:function(){}}),l}function Validate_Acq_Right_Title_Platform(n,t,i,r,u,f){var e="";return $.ajax({type:"POST",url:URL_Validate_Acq_Right_Title_Platform,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",async:!1,data:JSON.stringify({hdnPlatform:n,hdnMMovies:t,Right_Type:i,Is_Tentative:r,Start_Date:u,End_Date:f}),success:function(n){n=="true"&&redirectToLogin();e=n},error:function(){}}),e}function Cancel_Rights(){$("#hdnCommandName").val("CANCEL");showAlert("I","All unsaved data will be lost, still wants to go ahead? ","OKCANCEL")}function handleCancel(){CommandName=="COPY_HB"&&$.ajax({type:"POST",url:"/Syn_Rights/CancelHoldbackCopy",success:function(n){CommandName="";n=="true"&&redirectToLogin()},error:function(){}})}function chkHoldback_TitleLanguage(n){var t="NO";if(n.checked||$("#Title_Language_Added_For_Holdback").val()=="Y"&&(t="YES"),t=="YES")return showAlert("E","Holdback already added for Title Language"),$("#hdnIs_Title_Language_Right").val(!n.checked),!1;$("#hdnIs_Title_Language_Right").val(n.checked)}function chkIsExclusive(n){$("#hdnIs_Exclusive").val(n.checked)}function BindPlatform(){var n="";$("#lbTitles").val()!=null&&(n=$("#lbTitles").val().join(","));$.ajax({type:"POST",url:URL_BindPlatformTreeView,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",data:JSON.stringify({strPlatform:$("#hdnTVCodes").val(),strTitles:n}),async:!0,success:function(n){n=="true"&&redirectToLogin();$("#tree").html(n);IsHideLoading&&(hideLoading(),IsHideLoading=!1)},error:function(){}})}function OnSuccess(n){if(hideLoading(),$.type(n)=="array")return CommandName="COPY_HB",HB_Code=n,showAlert("E","Do you want to copy holdback from Acquisition?","OKCANCEL"),!1;n=="ERROR"?Show_Validation_Popup("",5,0):n!=""&&$.ajax({type:"POST",url:URL_ShowRestriction_Remarks_Popup,traditional:!0,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",async:!0,success:function(n){n=="true"&&redirectToLogin();$("#BindRestRemarksPopup").html(n);$("#popupRestRemarks").modal();initializeExpander()},error:function(){}})}function CloseRestRemarks(){if(showLoading(),$("#popupRestRemarks").modal("hide"),$(".modal-backdrop").hide(),$("#hdnTabName").val()=="")BindPartialTabs(pageRights_List);else{var n=$("#hdnTabName").val();BindPartialTabs(n)}hideLoading()}function TreeViewSelectedChange(n){n.id!="Rights_HB_Platform"&&BindDropdown("A","PF")}function fillTotal(){var t=0,n="";$("#lbTerritory option:selected").length>0&&$("#lbTerritory option:selected").each(function(){n=n==""?$(this).val():n+","+$(this).val();t++});$("#lblTerritoryCount").html(t)}function ShowHideSublicensingList(n){n?$("#divSublicensingList").show():$("#divSublicensingList").hide()}var IsHideLoading=!0,MessageFrom,CommandName,HB_Code;$(document).ready(function(){function r(n,t){var i=CalculateMonthBetweenTwoDate(n,t),r=i/12,u=i%12;return parseInt(r)+"."+u}function i(){var f=$("#Start_Date"),e=$("#End_Date"),i=new Date(MakeDateFormate(f.val())),n=new Date(MakeDateFormate(e.val())),u,t;isNaN(i)||isNaN(n)||(n.setDate(n.getDate()+1),u=r(i,n),t=u.split("."),$("#Term_YY").val(t[0]),$("#Term_MM").val(t[1]))}var n,t;setChosenWidth("#ROFR_Code","40%");$("#lblCountry").text("Country");Record_Locking_Code_G>0&&(n=URL_Refresh_Lock,Call_RefreshRecordReleaseTime(Record_Locking_Code_G,n));(MODE_G=="E"||MODE_G=="C")&&(SetRightPeriod(Right_Type_G),Is_Theatrical_Right_G=="Y"&&($("#lblTheatrical").show(),$("#lblCountry").text("Circuit"),$("#"+TreeId_G).hide()),Right_Type_G==YearBased&&(SetMinDt(),SetMaxDt()),Disable_SubLicensing_G=="Y"&&$("#Sub_License_Code").prop("disabled",!0),Disable_Tentative_G=="Y"&&$("#Is_Tentative").prop("disabled",!0),Is_Tentative_G=="Y"&&($("#End_Date").prop("disabled",!0),$("#End_Date").val("")),Disable_Thetrical_G=="Y"&&$("#Is_Theatrical_Right").prop("disabled",!0),Disable_IsExclusive_G=="Y"&&$("#Is_Exclusive").prop("disabled",!0),Disable_TitleRights_G=="Y"&&$("#Is_Title_Language_Right").prop("disabled",!0),Disable_RightType_G=="Y"?Existing_RightType_G==YearBased?($('#tabValidity a[href="#tabPerp"]').prop("disabled",!0),$('#tabValidity a[href="#tabPerp"]').prop("title","Can not select right type perpetuity as rights already syndicated")):($('#tabValidity a[href="#tabCal"]').prop("disabled",!0),$('#tabValidity a[href="#tabCal"]').prop("title","Can not select right type year based as rights already syndicated")):Disable_RightType_G=="M"?($('#tabValidity a[href="#tabCal"]').prop("disabled",!0),$('#tabValidity a[href="#tabPerp"]').prop("disabled",!0)):Disable_RightType_G=="R"&&($('#tabValidity a[href="#tabPerp"]').prop("disabled",!0),$('#tabValidity a[href="#tabPerp"]').prop("title","Can not select right type perpetuity as run definition already added")),t=document.getElementById("Restriction_Remarks"),countChar(t));$("#lbTitles").change(function(){if(showLoading(),SetTitleLanguage(),$("#Is_Theatrical_Right").prop("checked")==!0){var n="";$("#lbTitles").val()!=null&&(n=$("#lbTitles").val().join(","));$.ajax({type:"POST",url:URL_CheckTheatrical,traditional:!0,async:!1,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",data:JSON.stringify({titleCodes:n}),success:function(n){n=="true"&&redirectToLogin();$("#lblTheatrical").hide();$("#hdnTVCodes").val("");n==Theatrical_Platform_Code_G&&($("#lblCountry").text("Circuit"),$("#lblTheatrical").show(),$("#"+TreeId_G).hide(),$("#hdnTVCodes").val(Theatrical_Platform_Code_G),Is_Theatrical="Y",$("#tree").removeClass("required"));TreeViewSelectedChange($("#Is_Theatrical_Right"))},error:function(n){alert(n.responseText);hideLoading()}})}else BindPlatform(),TreeViewSelectedChange(document.getElementById("Rights_Platform"));hideLoading()});$("#lbTitles + .chosen-container .btnSelectAll").click(function(){if(SetTitleLanguage(),$("#Is_Theatrical_Right").prop("checked")==!0){var n="";$("#lbTitles").val()!=null&&(n=$("#lbTitles").val().join(","));$.ajax({type:"POST",url:URL_CheckTheatrical,traditional:!0,async:!1,enctype:"multipart/form-data",contentType:"application/json; charset=utf-8",data:JSON.stringify({titleCodes:n}),success:function(n){n=="true"&&redirectToLogin();$("#lblTheatrical").hide();$("#hdnTVCodes").val("");n==Theatrical_Platform_Code_G&&($("#lblCountry").text("Circuit"),$("#lblTheatrical").show(),$("#"+TreeId_G).hide(),$("#hdnTVCodes").val(Theatrical_Platform_Code_G),Is_Theatrical="Y",$("#tree").removeClass("required"));TreeViewSelectedChange($("#Is_Theatrical_Right"))},error:function(n){alert(n.responseText)}})}else BindPlatform(),TreeViewSelectedChange(document.getElementById("Rights_Platform"))});$("#Is_Theatrical_Right").change(function(){showLoading();SetTheatrical("C");hideLoading()});$("#Is_Tentative").change(function(){OnClickTentative()});$("#ROFR_DT").change(function(){CalculateROFRDays()});$("#ROFR_Days").change(function(){CalculateROFRDate()});$("#Term_YY").change(function(){OnFocusLostTerm();Set_MinMax_ROFR()});$("#Term_MM").change(function(){OnFocusLostTerm();Set_MinMax_ROFR()});$("#Start_Date").change(function(){SetMinDt();i()});$("#End_Date").change(function(){SetMaxDt();i()});$("#Term_YY").numeric({allowMinus:!1,allowThouSep:!1,allowDecSep:!1,maxPreDecimalPlaces:2,maxDecimalPlaces:0});$("#Term_MM").numeric({allowMinus:!1,allowThouSep:!1,allowDecSep:!1,maxPreDecimalPlaces:2,maxDecimalPlaces:0});$("#ROFR_Days").numeric({allowMinus:!1,allowThouSep:!1,allowDecSep:!1,maxPreDecimalPlaces:3,maxDecimalPlaces:0});BindListandDdl()});MessageFrom="";CommandName="";HB_Code=[];
//# sourceMappingURL=Syn_Deal_Rights.min.js.map
