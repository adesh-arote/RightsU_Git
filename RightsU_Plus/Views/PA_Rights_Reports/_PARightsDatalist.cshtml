@model List<RightsU_Entities.Acq_Adv_Ancillary_Report>

<script>
    var pos = null;
    var URL_BindCriteriaDetailsPopup = '@Url.Action("BindCriteriaDetailsPopup", "Reports")';

    $(document).ready(function () {
        debugger
        initializeTooltip();
        $('#lblRecordCount').text('@ViewBag.RecordCount');
        $("#hdnRecordCount").val('@ViewBag.RecordCount');
        $('.clsPlatformPopup').on('click', function (e) {
            debugger
            var btdId = e.target.id;
            //var hdnRightCodeID = btdId.replace("_aViewPlatform", "_hdnRightCode");
            var MURCode = e.target.id.slice(3);
            pos = $('#' + btdId).offset();
            pos.left = 810;

            $.ajax({
                type: "POST",
                url: URL_BindCriteriaDetailsPopup,
                traditional: true,
                enctype: 'multipart/form-data',
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({
                    AcqAdvAncillaryReportCode: MURCode
                }),
                async: false,
                success: function (result) {
                    if (result == "true") {
                        redirectToLogin();
                    }
                    $('#divCriteriaDetails').html(result);
                    $('#popupFade').offset({ top: pos.top, left: pos.left }).fadeIn();
                    $('#popupFade').offset({ top: pos.top, left: pos.left }).fadeIn();
                },
                error: function (result) { }
            });
            return false;
        });

        $("#popupFade").click(function (event) {
            event.stopPropagation();
        });

        SetPaging();
        GetMURStatus();
    });
    function FadeOutPopup() {
        $('#divCriteriaDetails').empty();
        $('#popupFade').offset({ top: pos.top, left: pos.left }).fadeOut();
        return false;
    }
    //$('.expand_Name').expander({
    //    slicePoint: 30,
    //    expandPrefix: '',
    //    expandText: '...Read more',
    //    collapseTimer: 0,
    //    userCollapseText: '<span>[^]</span>'
    //});
</script>
<style>
    #popupFade {
        position: absolute;
        display: none;
        width: 300px;
        overflow: auto;
        border: #bbb 1px solid;
        z-index: 100;
    }

        #popupFade .modal-dialog ul.fancytree-container {
            height: 100%;
            border: 0;
            overflow-y: auto;
        }

        #popupFade form .modal_block {
            padding: 3px 10px;
        }

        #popupFade #Rights_List_Platform {
            max-height: 300px;
        }

    /*.clsPlatformPopup {
        color: #2b64a5;
        font-size: 11px;
        font-style: italic;
    }*/
</style>
<table class="table table-bordered table-hover" id="tblDealData">
    <thead>
        <tr>
            <th style="width:35%;">Report Name</th>
            <th style="width:13%;">Accessibility</th>
            <th style="width:15%;">Generated By</th>
            <th style="width:12%;">Generated On</th>
            <th style="width:10%;">Report Details</th>
            <th style="width:10%;">Action</th>
        </tr>
    </thead>
    <tbody>
        @if (Model.Count > 0)
        {
            foreach (var item in Model)
            {

                <tr>
                    <td style="text-align:left">
                        <input type="hidden" id="hdnDeleteId" />
                        <span class="expandable"> @item.Report_Name</span>
                    </td>
                    <td style="text-align:center">
                        @if(item.Accessibility == "P         ")
                        {
                            item.Accessibility = "P";
                        }
                        @if (item.Accessibility.Trim() == "P")
                        {
                            <span>Public</span>
                        }
                        else
                        {
                            <span>Private</span>
                        }
                    </td>
                    <td style="text-align:center">
                        <span>@item.Created_By</span>
                    </td>
                    <td style="text-align:center">
                        <span>
                            @string.Format("{0:dd-MMM-yyyy}", item.Generated_On)
                        </span>
                    </td>
                    <td style="text-align:center;">
                        <span>
                            <a id="CD_@item.Acq_Adv_Ancillary_Report_Code" title="Report Details" style="cursor:pointer;" class="glyphicon glyphicon-collapse-down clsPlatformPopup"></a>
                        </span>
                    </td>
                    <td style="text-align:center;" class="deal_action clsTdAction_@item.Acq_Adv_Ancillary_Report_Code@item.Report_Status">
                        @if (item.Report_Status == "C")
                        {
                            <a title="Download" class="glyphicon glyphicon-save" style="cursor:pointer;" onclick="DownloadReport(@item.Acq_Adv_Ancillary_Report_Code)"></a>
                            <a title="Delete" class="glyphicon glyphicon-trash" style="cursor: pointer;" onclick="DeleteConfirmation(@item.Acq_Adv_Ancillary_Report_Code)"></a>
                            <a title="Re-Run" class="glyphicon glyphicon-refresh" style="cursor:pointer;" onclick="RefreshReport(@item.Acq_Adv_Ancillary_Report_Code)"></a>
                        }
                        @if (item.Report_Status == "P")
                        {
                        <img id="imgLoading_@item.Acq_Adv_Ancillary_Report_Code" title="In Process" src="~/Images/square_dots_loading.gif" style="height: 26px;" />
                        <a id="Error_@item.Acq_Adv_Ancillary_Report_Code" title="Please Contact Administrator" class="glyphicon glyphicon-exclamation-sign" ></a>
                        <a id="NRF_@item.Acq_Adv_Ancillary_Report_Code" title="No Record Found" class="glyphicon glyphicon-exclamation-sign" style="color: red;"></a>
                        }
                        @if (item.Report_Status == "E")
                        {
                            <a title="Please Contact Administrator" class="glyphicon glyphicon-exclamation-sign" style="color: red;"></a>
                        }
                        @if (item.Report_Status == "N")
                        {
                            <a title="No Record Found" class="glyphicon glyphicon-exclamation-sign" style="color: red;"></a>
                            <a title="Delete" class="glyphicon glyphicon-trash" style="cursor: pointer;" onclick="DeleteConfirmation(@item.Acq_Adv_Ancillary_Report_Code)"></a>
                            <a title="Re-Run" class="glyphicon glyphicon-refresh" style="cursor:pointer;" onclick="RefreshReport(@item.Acq_Adv_Ancillary_Report_Code)"></a>
                        }
                    </td>
                </tr>
            }
        }
        else
        {
            <tr>
                <td colspan="6">No record found</td>
            </tr>
        }
    </tbody>
</table>

<div id="popupFade">
    <div class="modal-dialog">
        <div class="modal-content clearfix">
            <form class="form">
                <div class="form_fields">
                    <div class="modal_block modal_header">
                        <a class="close" onclick="FadeOutPopup()">
                            <span>×</span>
                            <span class="sr-only">Close</span>
                        </a>
                        <h5>Criteria Details</h5>
                    </div>
                    <div class="modal_block" id="divCriteriaDetails" style="overflow : scroll; height:200px;">
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>