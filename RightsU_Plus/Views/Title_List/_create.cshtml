@model RightsU_Entities.Title
@{
    MessageKey objMessageKey = new MessageKey();
    if (Session["objMessageKey"] != null)
    {
        objMessageKey = (MessageKey)Session["objMessageKey"];
    }
}
<script type="text/javascript">

     var URL_SaveTitle = '@Url.Action("SaveTitle", "Acq_General")';

    $(document).ready(function () {
        debugger;

        if ('@ViewBag.fromAcqGeneral' == 'Y') {
            $("#ddlDealType").val(@ViewBag.DealTypeCode).trigger("chosen:updated");
            $("#btnAddAdditionalmetadata").hide();
        }


        if ('@objMessageKey.LayoutDirection' == 'RTL') {
            //$('.form_links').addClass('form_links-Head')
            //$('.close').addClass('close-Head')
        }
        $("#ddlDealType").change(function () {
            debugger;
            if ($("#ddlDealType").val() == '@ViewBag.CodeForEmbeddedMusic') {
                $("#liMusicLabel").show();
            }
            else
                $("#liMusicLabel").hide();
        })
        $("#txtDuration").numeric({
            allowMinus: false,
            allowThouSep: true,
            allowDecSep: true,
            maxDecimalPlaces: 2,
            maxPreDecimalPlaces: 3
        });
    })

    function LanguageOnChange(obj)
    {

        if (obj.selectedIndex > 0) {
            $("#ddlLanguage").removeClass('required');
            $("#ddlLanguage").trigger("chosen:updated");
        }
    }



    function general(TitleCode) {
        debugger;
        var arrTitleCodes = TitleCode;
        $("#divTitle").removeClass("required");
        if (arrTitleCodes != null) {
            showLoading();
            Enable_DisableControl(true);
            titleCodes = arrTitleCodes;
            $('#popAddDealMovie').modal('hide')

            valid = SaveTitleListData(false);
            if (!valid)
                return false;

            var dealTypeCode = GetDealTypeCode();
            $.ajax({
                type: "POST",
                url: URL_SaveTitle,
                traditional: true,
                enctype: 'multipart/form-data',
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({
                    titleCodes: titleCodes,
                    dealTypeCode: dealTypeCode
                }),
                async: false,
                success: function (result) {
                    if (result == "true") {
                        redirectToLogin();
                    }
                    else {
                        if (result.Status == "S") {
                            $('#imgTitleIcon').prop("src", result.Title_Icon_Path);
                            $('#divTitleIcon').attr("title", result.Title_Icon_Tooltip);
                            BindTitleGridview();
                            addNumeric();
                            BindTitleLabel(true);
                            hideLoading();
                        }
                    }
                },
                error: function (result) {
                    alert('Error: ' + result.responseText);
                }
            });
        }
        else {
            $("#divTitle").addClass("required");
            showAlert("E", ShowMessage.MsgForSelectTitle, 'ddlTitle')//MsgForSelectTitle = Please select atleast one title
        }
    }

    function BindTitle() {

        var hdnddlDealType = "";

        if ($("#ddlDealType").val() != "") {
            hdnddlDealType = $("#ddlDealType").val();
        }
        //var abc = '';
        $.ajax({
            type: "POST",
            url: '@Url.Action("BindTitle_Ajax", "Title_List")',
            traditional: true,
            enctype: 'multipart/form-data',
            async: false,
            data: JSON.stringify({
                Selected_deal_type_Code: '@ViewBag.DealTypeCodeSearch',
                Selected_BUCode: 0,
                Selected_Title_Codes: ""
            }),
            contentType: "application/json; charset=utf-8",
            success: function (result) {

                $.each(result, function () {
                    $("#lbTitle_Code").append($("<option />").val(this.Value).text(this.Text));
                });
                $("#lbTitle_Code").trigger("chosen:updated");
                initializeChosen();
            },
            error: function (result) {
            }
        });
    }


</script>
<style>
    /*.form_links-Head li {
        float: right !important;
        list-style-type: none;
        margin-right: 10px;
    }
     .close-Head {
            float: left;
            font-size: 22px;
            font-weight: 700;
            line-height: 1;
            color: #000;
            text-shadow: 0 1px 0 #fff;
            filter: alpha(opacity=20);
            opacity: .3;
            padding-left: 28px;
            /*position: relative;
                top: -21px;
    }
    */
</style>

<div class="modal-dialog" dir="@objMessageKey.LayoutDirection">
    <div class="modal-content clearfix">
        <form class="form" id="movie_popup">
            <div class="form_wrapper">
                <div class="form_fields">
                    <div class="modal_block modal_header">
                        <a class="close" data-dismiss="modal" href="#">
                            <span>×</span>
                            <span class="sr-only">Close</span>
                        </a>
                        @*<h2>@objMessageKey.AddTitle</h2>*@
                        <h2>Add Title</h2>
                    </div>
                    <div class="modal_block">
                        <ul class="add_title_popup">
                            <li>
                                <label>@objMessageKey.Type</label>
                                @Html.Hidden("hdnddlDealType")
                                @Html.Hidden("hdnddlLanguage")

                                @Html.DropDownList("ddlDealType", (List<SelectListItem>)ViewBag.DealType, new { @id = "ddlDealType", @class = "form_input chosen-select" })
                            </li>
                            <li>
                                <label>@objMessageKey.TitleName</label>
                                @Html.TextBoxFor(m => Model.Title_Name, new { @id = "txtTitleName", @class = "form_input", @MaxLength = "500" })
                            </li>
                            <li>
                                <label>@objMessageKey.TitleLanguage</label>
                                @Html.DropDownList("ddlLanguage", (List<SelectListItem>)ViewBag.Language, new { @id = "ddlLanguage", @class = "form_input chosen-select", @onchange = "LanguageOnChange(this);" })
                            </li>
                            @if (Enumerable.Count(ViewBag.LstExtendedColumns) > 0)
                            {
                                <li style="margin-top:15px;">
                                    <label>@objMessageKey.TitleProgramCategory</label>
                                    @Html.DropDownList("LstExtendedColumns", (List<SelectListItem>)ViewBag.LstExtendedColumns, new { @id = "ddlProgramCategory", @class = "form_input chosen-select" })
                                </li>

                            }
                            @if ((string)ViewBag.IsTitleDurationMandatory == "Y")
                            {
                                <li style="margin-top:15px;">
                                    <label>@objMessageKey.Duration</label>
                                    @Html.TextBoxFor(m => Model.Duration_In_Min, new { @id = "txtDuration", @style = "width:95%" })
                                </li>
                            }
                            <li id="liMusicLabel" style="display:none">
                                <label>@objMessageKey.MusicLabel</label>
                                @Html.DropDownList("ddlMusicLabel", (List<SelectListItem>)ViewBag.MusicLabelList,
                                          new { @id = "ddlMusicLabel", @class = "form_input chosen-select" })
                            </li>
                        </ul>
                    </div>
                    <div class="modal_block_full">
                        <div class="form_links">
                            <ul class="modal_block clearfix">
                                <li>
                                    @if (@ViewBag.fromAcqGeneral == "Y")
                                    {
                                        <a class="btn btn-primary" href="#" onclick="ValidateSavefromAcqGeneral('S');">@objMessageKey.Save</a>
                                    }
                                    else
                                    {
                                        <a class="btn btn-primary" href="#" onclick="ValidateSave('S');">@objMessageKey.Save</a>
                                    }

                                </li>
                                <li>
                                    <a class="btn btn-primary" href="#" id="btnAddAdditionalmetadata" onclick="ValidateSave('SS');">@objMessageKey.AddAdditionalmetadata</a>
                                </li>
                                <li>
                                    <a data-dismiss="modal" class="btn btn-primary" href="#">@objMessageKey.Cancel</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

